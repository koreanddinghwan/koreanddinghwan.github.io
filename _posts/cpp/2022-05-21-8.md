---
title: "[C++] 복사생성자"
excerpt: "복사생성자"

categories:
  - cpp
tags:
  - cpp
  - syntax

toc: true
toc_sticky: true

date: 2022-05-21
last_modified_at: 2022-05-21
---

<br>
<br>

REF : 윤성우의 열혈 C++

## 복사 생성자

- 생성자의 한 형태
- 객체를 복사한다.

```cpp
int main(void)
{
	SoSimple sim1(15, 20);
	SoSimple sim2=sim1;
	sim2.ShowSimpleData();
	return ;
}
```

- `SoSimple sim2=sim1;` 는 `SoSimple sim2(sim1);`과 같은 의미로 해석된다. 
	1. SoSimple형 객체를 생성하고
	2. 객체의 이름은 sim2로하고
	3. sim1을 인자로 받는 생성자를 호출해 객체 생성을 완료한다.
- 이때 호출되는게 `복사생성자`이다.

- 예시  
	```cpp
	SoSimple(const SoSimple &copy) : num1(copy.num1), num2(copy.num2)
	{
		cout<<"Called SoSimple(SoSimple &copy"<<endl;
	}
	```

<br>

### 자동으로 삽입되는 디폴트 복사 생성자

- 복사생성자를 정의하지 않으면, 멤버 대 멤버의 복사를 진행하는 `디폴트 복사 생성자`가 자동으로 삽입된다.
 
 <br>

 ### 묵시적 변환을 막는 explicit

 ```cpp
 SoSimple sim2 = sim1;
 SoSimple sim2(sim1);
 ```
 - 위의 코드는 아래의 코드로 묵시적 변환이 일어나서 복사 생성자가 호출된다.  
 - 복사생성자의 묵시적 호출을 허용하지 않기 위해선  
	```cpp
	explicit SoSimple(const SoSimple &copy) : num1(copy.num1), num2(copy.num2)
	{
	}
	```
	이렇게 선언해준다.


<br>
<br>

## 깊은 복사와 얕은 복사

- `디폴트 복사 생성자`는 `멤버 대 멤버의 복사`를 진행한다.
- 그리고 이러한 방식의 복사는 `얕은 복사`라고한다.
- 이 경우에는, 멤버변수의 힘의 메모리 공간을 참조하면 문제를 일으킨다.
- 멤버의 메모리를 참조해 값을 복사해 할당하는 복사이므로, 
- 두 번 메모리 할당을 해제하면 2번째에서 double free 오류를 보게된다.

<br>

### 깊은 복사를 위한 복사생성자의 정의

- 각각의 객체는 포인터로 참조하는 대상까지 깊게 복사한다. 







