---
title: "philosophers(2)"
excerpt: "I never thought philosophy would be so deadly"

categories:
  - philosophers
tags:
  - 42seoul

toc: true
toc_sticky: true

date: 2022-05-15
last_modified_at: 2022-05-15
---

<br><br>

minitalk에서 프로세스의 개념이 나와서 운영체제에 대해 공부하며 과제를 진행했다.  
자연스럽게 뒤에 나오는 쓰레드에 대해서도 공부해야한다는 걸 알았는데, 강의 주제 중 philosopher에 대한 내용도 있더라...  

minitalk/pipex 에서 프로세스의 개념에 대해 공부하고,  
philosophers에서 쓰레드에 개념에 대해 익히는 순서대로 공부를 하게된다.  

순서대로 따라가다보면 체계적인 느낌으로 과제를 준다는게 느껴진다.  


## overview

- 메모리에 올라간 여러 프로세스들은
- `concurrently`하게 `state`가 변하고,
- `CPU time sharing`을 통해 `context switching`을 하며
- 사용자가 각 프로세스들이 `동시에 동작하고 있다`라고 느끼게된다.  

minitalk에서 공부했던 프로세스들은 `단일 쓰레드`로 프로그램을 구동하는 것이었는데,  
process는 사실 `multi threads`로 동작할 수 있다.  

- thread란
  - lightweight process이다.
  - CPU utilization의 기본 단위이다.
  - thread ID, program counter, register set, stack 로 이루어져 있다.
  ![IMG_9C1C151F1080-1](https://user-images.githubusercontent.com/76278794/168482298-30dd3ec0-76d6-45d2-adc0-259579d37ce4.jpeg)
  - code, data, files 는 공유하되,
  - 각 쓰레드는 register set, stack, program counter를 달리한다.

<br>

- multithreading 의 장점
  - server-client를 예시로하자.
  - client의 request를 server가 처리해야하는데, 
    - 서버가 이를 처리하기위해 프로세스를 새로 만든다면 
      - 시간과 자원을 많이 사용하게된다.
    - 만약 쓰레드를 만들어 처리한다면
      - 서버는 client의 request를 처리하는 thread를 따로 만들어 처리하고, 
      - 추가적인 request를 listening 하고있게 된다.

<br>

- kernel
  - 대부분의 운영체제 커널들또한 multithread이다.
    - 예를들어, 리눅스 시스템이 부팅될때,
      - 장치 관리, 메모리 관리, interrupt 핸들러와 같은 쓰레드들이 만들어진다.
      - pid 2인 kthreadd가 모든 커널 쓰레드들의 부모이다.
    - 기본적인 정렬, 트리, 그래프 알고리즘이 멀티쓰레딩의 장점을 이용할 수 있다.


<br>

- 장점
  1. Responsiveness
    - 시간이 오래 걸리는 작업을 하더라도, 프로그램이 계속 구동된다.
    - 단일 쓰레드였다면 해당 동작이 끝날때까지 멈추겠지만, 
    - 비동기 쓰레드로 구분해 시간이 오래걸리는 작업을 처리하면 어플리케이션은 유저에게 반응할 수 있다.
  2. Resource sharing
    - 프로세스들은 shared memory와 message queue 로만 자원을 공유할 수 있는데,
    - 쓰레드는 프로세스의 자원을 공유한다.
    - code영역와 data 영역을 공유함으로써, 같은 주소 공간에서 다른 동작을 하는 쓰레드를 만들 수 있다.
  3. Economy
    - 프로세스를 만들어 메모리와 자원을 할당하는건 비용이 많이 든다.
    - 하지만 쓰레드는 프로세스의 자원을 공유하기때문에 
      - 생성할때 경제적이고, context-switch 할때도 경제적이다.
        - 일반적으로 프로세스를 생성하는게 시간, 메모리가 많이 들며,
        - context switching또한 많이 든다.
  4. Scalability
    - 단일 쓰레드 프로세스는 1개의 프로세서만 사용할 수 있지만,
    - 멀티 쓰레드 프로세스는 멀티프로세서 아키텍처에서 
      - 각각 다른 프로세싱 코어에서 병렬적으로 구동될 수 있다.

